{"tasks":[{"environment":{},"displayName":"Replace tokens in **/*.json","alwaysRun":false,"continueOnError":false,"condition":"succeeded()","enabled":true,"timeoutInMinutes":0,"retryCountOnTaskFailure":0,"inputs":{"rootDirectory":"$(System.DefaultWorkingDirectory)/_Prechart.Service/","targetFiles":"**/*.json","encoding":"auto","tokenPattern":"default","tokenPrefix":"#{","tokenSuffix":"}#","writeBOM":"true","escapeType":"auto","escapeChar":"","charsToEscape":"","verbosity":"normal","actionOnMissing":"warn","keepToken":"false","actionOnNoFiles":"continue","enableTransforms":"false","transformPrefix":"(","transformSuffix":")","variableFiles":"","inlineVariables":"","variableSeparator":".","enableRecursion":"false","useLegacyPattern":"false","useLegacyEmptyFeature":"true","useDefaultValue":"false","emptyValue":"(empty)","defaultValue":"","enableTelemetry":"true"},"task":{"id":"a8515ec8-7254-4ffd-912c-86772e2b5962","versionSpec":"5.*","definitionType":"task"}},{"environment":{},"displayName":"Replace tokens in **/*.prod.ts","alwaysRun":false,"continueOnError":false,"condition":"succeeded()","enabled":true,"timeoutInMinutes":0,"retryCountOnTaskFailure":0,"inputs":{"rootDirectory":"$(System.DefaultWorkingDirectory)/_Prechart.Service/Prechart.Portal/src/environments","targetFiles":"**/*.prod.ts","encoding":"auto","tokenPattern":"default","tokenPrefix":"#{","tokenSuffix":"}#","writeBOM":"true","escapeType":"auto","escapeChar":"","charsToEscape":"","verbosity":"normal","actionOnMissing":"warn","keepToken":"false","actionOnNoFiles":"continue","enableTransforms":"false","transformPrefix":"(","transformSuffix":")","variableFiles":"","inlineVariables":"","variableSeparator":".","enableRecursion":"false","useLegacyPattern":"false","useLegacyEmptyFeature":"true","useDefaultValue":"false","emptyValue":"(empty)","defaultValue":"","enableTelemetry":"true"},"task":{"id":"a8515ec8-7254-4ffd-912c-86772e2b5962","versionSpec":"5.*","definitionType":"task"}},{"environment":{},"displayName":"Replace tokens in **/*.yml","alwaysRun":false,"continueOnError":false,"condition":"succeeded()","enabled":true,"timeoutInMinutes":0,"retryCountOnTaskFailure":0,"inputs":{"rootDirectory":"$(System.DefaultWorkingDirectory)/_Prechart.Service","targetFiles":"**/*.yml","encoding":"auto","tokenPattern":"default","tokenPrefix":"#{","tokenSuffix":"}#","writeBOM":"true","escapeType":"auto","escapeChar":"","charsToEscape":"","verbosity":"normal","actionOnMissing":"warn","keepToken":"false","actionOnNoFiles":"continue","enableTransforms":"false","transformPrefix":"(","transformSuffix":")","variableFiles":"","inlineVariables":"","variableSeparator":".","enableRecursion":"false","useLegacyPattern":"false","useLegacyEmptyFeature":"true","useDefaultValue":"false","emptyValue":"(empty)","defaultValue":"","enableTelemetry":"true"},"task":{"id":"a8515ec8-7254-4ffd-912c-86772e2b5962","versionSpec":"5.*","definitionType":"task"}},{"environment":{},"displayName":"Copy Configs","alwaysRun":false,"continueOnError":false,"condition":"succeeded()","enabled":true,"timeoutInMinutes":0,"retryCountOnTaskFailure":0,"inputs":{"script":"echo $(System.DefaultWorkingDirectory)/\ncd $(System.DefaultWorkingDirectory)/_Prechart.Service\n\necho \" cp $(System.DefaultWorkingDirectory)/_Prechart.Service/appsettings.json $(pathAppConfig)/appsettings.json\"\ncp $(System.DefaultWorkingDirectory)/_Prechart.Service/appsettings.json $(pathAppConfig)/appsettings.json\n\n\n\n \n ","workingDirectory":"","failOnStderr":"false"},"task":{"id":"d9bafed4-0b18-4f58-968d-86655b4d2ce9","versionSpec":"2.*","definitionType":"task"}},{"environment":{},"displayName":"Nginx Docker Down","alwaysRun":false,"continueOnError":false,"condition":"succeeded()","enabled":true,"timeoutInMinutes":0,"retryCountOnTaskFailure":0,"inputs":{"script":"cd /opt\n\nmkdir nginxproxymanager\n\ncd nginxproxymanager\n\n\necho $(System.DefaultWorkingDirectory)/\ncd $(System.DefaultWorkingDirectory)/_Prechart.Service\n\necho \" cp $(System.DefaultWorkingDirectory)/_Prechart.Service/docker-nginx-compose.yml /opt/nginxproxymanager/docker-nginx-compose.yml\"\ncp $(System.DefaultWorkingDirectory)/_Prechart.Service/docker-nginx-compose.yml /opt/nginxproxymanager/docker-nginx-compose.yml\n\ncd /opt/nginxproxymanager/\ndocker compose -f docker-nginx-compose.yml down\n\n\n\n \n \n","workingDirectory":"","failOnStderr":"false"},"task":{"id":"d9bafed4-0b18-4f58-968d-86655b4d2ce9","versionSpec":"2.*","definitionType":"task"}},{"environment":{},"displayName":"Main Service Docker Down","alwaysRun":false,"continueOnError":false,"condition":"succeeded()","enabled":true,"timeoutInMinutes":0,"retryCountOnTaskFailure":0,"inputs":{"script":"echo $(System.DefaultWorkingDirectory)/\ncd $(System.DefaultWorkingDirectory)/_Prechart.Service\nls -l\necho 'down'\ndocker compose -f docker-compose.yml down\n\n\n ","workingDirectory":"","failOnStderr":"false"},"task":{"id":"d9bafed4-0b18-4f58-968d-86655b4d2ce9","versionSpec":"2.*","definitionType":"task"}},{"environment":{},"displayName":"Main Service Docker Build","alwaysRun":false,"continueOnError":false,"condition":"succeeded()","enabled":true,"timeoutInMinutes":0,"retryCountOnTaskFailure":0,"inputs":{"script":"cd $(System.DefaultWorkingDirectory)/_Prechart.Service\necho 'build'\ndocker compose -f docker-compose.yml build","workingDirectory":"","failOnStderr":"false"},"task":{"id":"d9bafed4-0b18-4f58-968d-86655b4d2ce9","versionSpec":"2.*","definitionType":"task"}},{"environment":{},"displayName":"Main Service Docker Up","alwaysRun":false,"continueOnError":false,"condition":"succeeded()","enabled":true,"timeoutInMinutes":0,"retryCountOnTaskFailure":0,"inputs":{"script":"cd $(System.DefaultWorkingDirectory)/_Prechart.Service\n\necho 'up'\ndocker compose -f docker-compose.yml up  -d","workingDirectory":"","failOnStderr":"false"},"task":{"id":"d9bafed4-0b18-4f58-968d-86655b4d2ce9","versionSpec":"2.*","definitionType":"task"}},{"environment":{},"displayName":"Nginx Docker Up","alwaysRun":false,"continueOnError":false,"condition":"succeeded()","enabled":true,"timeoutInMinutes":0,"retryCountOnTaskFailure":0,"inputs":{"script":"cd /opt/nginxproxymanager/\ndocker compose -f docker-nginx-compose.yml build\ndocker compose -f docker-nginx-compose.yml up  -d\n\ndocker image prune -a --force","workingDirectory":"","failOnStderr":"false"},"task":{"id":"d9bafed4-0b18-4f58-968d-86655b4d2ce9","versionSpec":"2.*","definitionType":"task"}}],"runsOn":["Agent","DeploymentGroup"],"revision":21,"createdBy":{"displayName":"Emerson Tiamzon","id":"c664e297-18a9-6a2a-8967-6df104a179ec","uniqueName":"emerson@prechart.com"},"createdOn":"2022-08-12T06:51:23.147Z","modifiedBy":{"displayName":"Emerson Tiamzon","id":"c664e297-18a9-6a2a-8967-6df104a179ec","uniqueName":"emerson@prechart.com"},"modifiedOn":"2022-09-13T08:02:13.510Z","comment":"","id":"7d02ab93-f301-4eb3-b2a8-a918c4668e5f","name":"Deploy Docker Services","version":{"major":1,"minor":0,"patch":0,"isTest":false},"iconUrl":"https://cdn.vsassets.io/v/M207_20220809.6/_content/icon-meta-task.png","friendlyName":"Deploy Docker Services","description":"","category":"Deploy","definitionType":"metaTask","author":"Emerson Tiamzon","demands":[],"groups":[],"inputs":[{"aliases":[],"options":{},"properties":{},"name":"pathAppConfig","label":"pathAppConfig","defaultValue":"/home/nas/Prechart-Services/AppConfig/Staging","required":true,"type":"string","helpMarkDown":"","groupName":""}],"satisfies":[],"sourceDefinitions":[],"dataSourceBindings":[],"instanceNameFormat":"Task group: Deploy Docker Services $(pathAppConfig)","preJobExecution":{},"execution":{},"postJobExecution":{}}